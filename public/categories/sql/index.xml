<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sql on Mark Richman Consulting</title>
    <link>http://www.markrichman.com:1313/categories/sql/</link>
    <description>Recent content in Sql on Mark Richman Consulting</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 22 Oct 2013 17:17:19 +0000</lastBuildDate>
    <atom:link href="http://www.markrichman.com:1313/categories/sql/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Passing Lists as Parameters to Stored Procedures in SQL Server</title>
      <link>http://www.markrichman.com:1313/passing-lists-parameters-stored-procedures-sql-server/</link>
      <pubDate>Tue, 22 Oct 2013 17:17:19 +0000</pubDate>
      
      <guid>http://www.markrichman.com:1313/passing-lists-parameters-stored-procedures-sql-server/</guid>
      <description>&lt;p&gt;There is no good way to do this in SQL Server. Someday they will have an &lt;a href=&#34;http://www.postgresql.org/docs/9.1/static/arrays.html&#34;&gt;array datatype like PostgreSQL&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In SQL Server 2005 and higher, this can be done using XML, but I donâ€™t particularly see the need for the overhead. Use the function below to split a delimited string and select from the returned table. Its also very helpful for reporting.&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;
  &lt;pre&gt;&lt;code class=&#34;sql&#34;&gt;&amp;lt;span class=&#34;lineno&#34;&gt; 1&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;CREATE&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;FUNCTION&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;[&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;dbo&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;].[&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;SplitList&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;]&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt; &amp;lt;span class=&#34;nb&#34;&gt;VARCHAR&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;MAX&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;),&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;separator&amp;lt;/span&gt; &amp;lt;span class=&#34;nb&#34;&gt;VARCHAR&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;MAX&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;s1&#34;&gt;&#39;;&#39;&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 2&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;RETURNS&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;table&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;TABLE&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;Value&amp;lt;/span&gt; &amp;lt;span class=&#34;nb&#34;&gt;VARCHAR&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;MAX&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;))&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 3&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;AS&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;BEGIN&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 4&amp;lt;/span&gt;    &amp;lt;span class=&#34;k&#34;&gt;DECLARE&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;nb&#34;&gt;INT&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt; &amp;lt;span class=&#34;nb&#34;&gt;INT&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 5&amp;lt;/span&gt;    &amp;lt;span class=&#34;k&#34;&gt;SET&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;+&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;separator&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 6&amp;lt;/span&gt;    &amp;lt;span class=&#34;k&#34;&gt;SET&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;mi&#34;&gt;1&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 7&amp;lt;/span&gt;    &amp;lt;span class=&#34;k&#34;&gt;SET&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;CHARINDEX&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;separator&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 8&amp;lt;/span&gt;    &amp;lt;span class=&#34;n&#34;&gt;WHILE&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;lt;/span&gt; &amp;lt;span class=&#34;mi&#34;&gt;0&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;BEGIN&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 9&amp;lt;/span&gt;       &amp;lt;span class=&#34;n&#34;&gt;IF&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;-&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;lt;/span&gt; &amp;lt;span class=&#34;mi&#34;&gt;0&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;10&amp;lt;/span&gt;          &amp;lt;span class=&#34;k&#34;&gt;INSERT&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;INTO&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;table&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;VALUES&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;SUBSTRING&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;-&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;))&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;11&amp;lt;/span&gt;       &amp;lt;span class=&#34;n&#34;&gt;IF&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;&amp;gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;LEN&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;BREAK&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;12&amp;lt;/span&gt;       &amp;lt;span class=&#34;k&#34;&gt;SET&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;+&amp;lt;/span&gt; &amp;lt;span class=&#34;mi&#34;&gt;1&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;13&amp;lt;/span&gt;       &amp;lt;span class=&#34;k&#34;&gt;SET&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;position&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;CHARINDEX&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;separator&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;list&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;previous&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;14&amp;lt;/span&gt;    &amp;lt;span class=&#34;k&#34;&gt;END&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;15&amp;lt;/span&gt;    &amp;lt;span class=&#34;k&#34;&gt;RETURN&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;16&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;END&amp;lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;To use this function, simply pass your list, and specify the desired delimiter:&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;
  &lt;pre&gt;&lt;code class=&#34;sql&#34;&gt;&amp;lt;span class=&#34;k&#34;&gt;SELECT&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;*&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;FROM&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;dbo&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;SplitList&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;s1&#34;&gt;&#39;1,2,3,4,5&#39;&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;s1&#34;&gt;&#39;,&#39;&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This comes in handy when trying to report on, say, all unique customer emails who purchased a subset of SKUs in the past two days:&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;
  &lt;pre&gt;&lt;code class=&#34;sql&#34;&gt;&amp;lt;span class=&#34;lineno&#34;&gt; 1&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;DECLARE&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;tbl&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;TABLE&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;id&amp;lt;/span&gt; &amp;lt;span class=&#34;nb&#34;&gt;VARCHAR&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;mi&#34;&gt;7&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;));&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 2&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;INSERT&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;tbl&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;SELECT&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;*&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;FROM&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;dbo&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;SplitList&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;s1&#34;&gt;&#39;SKU1234,SKU2345,SKU3456,SKU4567&#39;&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt; &amp;lt;span class=&#34;s1&#34;&gt;&#39;,&#39;&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;);&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 3&amp;lt;/span&gt; 
&amp;lt;span class=&#34;lineno&#34;&gt; 4&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;SELECT&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;DISTINCT&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;LTRIM&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;RTRIM&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;c&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;email&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)))&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 5&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;FROM&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;CMS&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;o&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 6&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;INNER&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;JOIN&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;ITEMS&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;i&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;ON&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;o&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;ORDERNO&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;i&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;ORDERNO&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 7&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;INNER&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;JOIN&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;CUST&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;c&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;ON&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;c&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;CUSTNUM&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;o&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;CUSTNUM&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 8&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;WHERE&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;i&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;ITEM&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;IN&amp;lt;/span&gt; &amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;SELECT&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;id&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;FROM&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;@&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;tbl&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt; 9&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;AND&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;o&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;ODR_DATE&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;&amp;gt;=&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;DATEADD&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;day&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt;&amp;lt;span class=&#34;o&#34;&gt;-&amp;lt;/span&gt;&amp;lt;span class=&#34;mi&#34;&gt;2&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;,&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;GETDATE&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;())&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;10&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;AND&amp;lt;/span&gt; &amp;lt;span class=&#34;n&#34;&gt;LEN&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;(&amp;lt;/span&gt;&amp;lt;span class=&#34;k&#34;&gt;c&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;email&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;)&amp;lt;/span&gt; &amp;lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;lt;/span&gt; &amp;lt;span class=&#34;mi&#34;&gt;0&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;11&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;AND&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;c&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;email&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;IS&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;NOT&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;NULL&amp;lt;/span&gt;
&amp;lt;span class=&#34;lineno&#34;&gt;12&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;AND&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;c&amp;lt;/span&gt;&amp;lt;span class=&#34;p&#34;&gt;.&amp;lt;/span&gt;&amp;lt;span class=&#34;n&#34;&gt;email&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;NOT&amp;lt;/span&gt; &amp;lt;span class=&#34;k&#34;&gt;LIKE&amp;lt;/span&gt; &amp;lt;span class=&#34;s1&#34;&gt;&#39;%@example.com&#39;&amp;lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Why use this technique? Performance. You make one call to the database. For the detractors of this design pattern, I ask: why would it be a bad idea to pass a collection to a stored procedure? Is it a bad idea in .NET to pass a collection as an argument to a method?&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>